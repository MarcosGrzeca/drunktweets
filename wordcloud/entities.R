library(wordcloud)
library(tidyverse)
library(tidytext)
library(text2vec)
library(dplyr)
library(tidytext)
library(janeaustenr)

library(tools)
source(file_path_as_absolute("utils/getDados.R"))
source(file_path_as_absolute("baseline/dados.R"))

#Configuracoes
DATABASE <- "icwsm"
clearConsole();

dados <- query("SELECT GROUP_CONCAT(
                                    (
                                      SELECT GROUP_CONCAT(DISTINCT(tn.palavra) SEPARATOR '---')
                                      FROM chat_tweets_nlp tn
                                      WHERE tn.idTweet = t.id
                                      AND palavra IN ('mention', 'Hashtag', 'url', '/religion and spirituality/hinduism', '/religion and spirituality/buddhism', 'Download  Pilot', 'highest score', 'Miley Cyrus', 'giveaway', 'Billy Ray Cyrus', '/technology and computing/mp3 and midi', '/art and entertainment/movies and tv/children\\'s', '/technology and computing/software', '/food and drink', 'media', '/religion and spirituality/christianity', '/technology and computing/internet technology/web search', '/health and fitness/addiction/alcoholism', '/food and drink/beverages/alcoholic beverages/cocktails and beer', '/sports/bowling', '/food and drink/beverages', '/sports/cricket', '/food and drink/beverages/alcoholic beverages', '/food and drink/beverages/alcoholic beverages/wine', 'Saint Patrick\\'s Day', '/food and drink/beverages/non alcoholic beverages/soft drinks', '/society/dating', 'Quantity', 'Saint Patrick', '/business and industrial/business operations/business plans', '/society/unrest and war', '#media', '/food and drink/beverages/non alcoholic beverages/bottled water', 'bottle', '/health and fitness/drugs', '/family and parenting/children', 'mention Thanks', '/technology and computing/internet technology/email', '/sports/table tennis and ping-pong', 'drugs', '/health and fitness/addiction', '/health and fitness/addiction/smoking addiction', '/shopping/retail/outlet stores', 'Shamrock', '/religion and spirituality/islam', 'Irish folklore', 'https', '/society/social institution/divorce', '/business and industrial/advertising and marketing/advertising', 'store', '/automotive and vehicles/minivan', '/automotive and vehicles/boats and watercraft', '/art and entertainment/movies and tv/movies/reviews', 'gt', 'last night', '/art and entertainment/books and literature', 'Person', 'shots', '/food and drink/food', '/technology and computing/programming languages/javascript', 'Drug', 'wine', '#mention #media', 'Starbucks', '/law, govt and politics/politics/elections/presidential elections', '/law, govt and politics', 'text', 'Alcoholic beverage', 'St. Patrick\\'s Day')
                                      GROUP BY tn.idTweet
                                    ) SEPARATOR '---') AS entidades,
                        GROUP_CONCAT(
                                    (
                                      SELECT GROUP_CONCAT(DISTINCT(REPLACE(ty.type, 'http://dbpedia.org/class/', ')) SEPARATOR '---')
                                      FROM chat_tweets_nlp tn
                                      JOIN chat_tweets_conceito c ON c.palavra = tn.palavra
                                      JOIN resource_type ty ON ty.resource = c.resource
                                      WHERE tn.idTweet = t.id
                                      AND ty.type IN ('http://dbpedia.org/class/yago/WikicatVirtualCommunities', 'http://dbpedia.org/class/yago/Gathering107975026', 'http://dbpedia.org/class/yago/Community108223802', 'http://dbpedia.org/ontology/RecordLabel', 'http://dbpedia.org/class/yago/SocialGroup107950920', 'http://dbpedia.org/class/yago/Group100031264', 'http://dbpedia.org/class/yago/Abstraction100002137', 'http://dbpedia.org/class/yago/WikicatOccupationsInAviation', 'http://dbpedia.org/class/yago/WikicatMilitaryAviationOccupations', 'http://dbpedia.org/class/yago/WikicatPeopleFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatWaltDisneyRecordsArtists', 'http://dbpedia.org/class/yago/WikicatHollywoodRecordsArtists', 'http://dbpedia.org/class/yago/WikicatFascinationRecordsArtists', 'http://dbpedia.org/class/yago/WikicatMusiciansFromTennessee', 'http://dbpedia.org/class/yago/WikicatChildActors', 'http://dbpedia.org/class/yago/WikicatPeopleFromTennessee', 'http://dbpedia.org/class/yago/WikicatActorsFromTennessee', 'http://dbpedia.org/class/yago/WikicatActressesFromTennessee', 'http://dbpedia.org/class/yago/WikicatAmericanChildActresses', 'http://dbpedia.org/class/yago/WikicatAmericanChildActors', 'http://dbpedia.org/class/yago/WikicatAmericanFemaleDancers', 'http://dbpedia.org/class/yago/WikicatMusiciansFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatActressesFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatRCARecordsArtists', 'http://dbpedia.org/class/yago/WikicatChildPopMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanFemalePopSingers', 'http://dbpedia.org/class/yago/Dancer109989502', 'http://dbpedia.org/class/yago/WikicatAmericanGuitarists', 'http://dbpedia.org/class/yago/WikicatLGBTRightsActivistsFromTheUnitedStates', 'http://dbpedia.org/class/yago/WikicatAmericanVoiceActresses', 'http://dbpedia.org/class/yago/WikicatAmericanChildSingers', 'http://dbpedia.org/class/yago/Pianist110430665', 'http://dbpedia.org/class/yago/WikicatAmericanPianists', 'http://dbpedia.org/class/yago/WikicatAmericanVoiceActors', 'http://dbpedia.org/class/yago/WikicatAmericanDanceMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanActresses', 'http://dbpedia.org/class/yago/Guitarist110151760', 'http://dbpedia.org/class/yago/WikicatPopSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryActresses', 'http://dbpedia.org/class/yago/WikicatAmericanFemaleSingers', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionActresses', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionActors', 'http://dbpedia.org/class/yago/WikicatAmericanHipHopSingers', 'http://dbpedia.org/class/yago/Occupation100582388', 'http://dbpedia.org/class/yago/WikicatAmericanFilmActresses', 'http://dbpedia.org/class/yago/WikicatAmericanSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryAmericanActresses', 'http://dbpedia.org/class/yago/WikicatAmericanPopSingers', 'http://dbpedia.org/class/yago/WikicatEnglish-languageSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryActors', 'http://dbpedia.org/class/yago/Wikicat21st-centuryAmericanSingers', 'http://dbpedia.org/class/yago/Actress109767700', 'http://dbpedia.org/class/yago/WikicatActors', 'http://dbpedia.org/class/yago/WikicatAmericanMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanActors', 'http://dbpedia.org/class/yago/WikicatWomen', 'http://dbpedia.org/class/yago/Militant110315837', 'http://umbel.org/umbel/rc/MusicalPerformer', 'http://dbpedia.org/class/yago/Female109619168', 'http://dbpedia.org/class/yago/Woman110787470', 'http://dbpedia.org/class/yago/Disputant109615465', 'http://dbpedia.org/class/yago/Reformer110515194', 'http://dbpedia.org/class/yago/Actor109765278', 'http://dbpedia.org/class/yago/Singer110599806', 'http://dbpedia.org/ontology/MusicalArtist', 'http://dbpedia.org/class/yago/WikicatAmericanPeople', 'http://www.w3.org/2002/07/owl#Thing', 'http://dbpedia.org/class/yago/Musician110340312', 'http://dbpedia.org/class/yago/Musician110339966', 'http://dbpedia.org/class/yago/Artist109812338', 'http://dbpedia.org/class/yago/Performer110415638', 'http://dbpedia.org/class/yago/Entertainer109616922', 'http://dbpedia.org/class/yago/Adult109605289', 'http://dbpedia.org/class/yago/Activity100407535', 'http://dbpedia.org/class/yago/Creator109614315', 'http://dbpedia.org/class/yago/CausalAgent100007347', 'http://dbpedia.org/class/yago/Organism100004475', 'http://dbpedia.org/class/yago/LivingThing100004258', 'http://dbpedia.org/class/yago/Person100007846', 'http://dbpedia.org/ontology/Building', 'http://dbpedia.org/class/yago/Act100030358', 'http://dbpedia.org/class/yago/Event100029378', 'http://dbpedia.org/ontology/Person', 'http://dbpedia.org/class/yago/WikicatLivingPeople', 'http://www.ontologydesignpatterns.org/ont/dul/DUL.owl#NaturalPerson', 'http://schema.org/Person', 'http://www.wikidata.org/entity/Q5', 'http://www.wikidata.org/entity/Q215627', 'http://xmlns.com/foaf/0.1/Person', 'http://dbpedia.org/class/yago/PsychologicalFeature100023100', 'http://dbpedia.org/class/yago/Maker110284064', 'http://dbpedia.org/class/yago/Manufacturer110292316', 'http://dbpedia.org/class/yago/YagoLegalActor', 'http://dbpedia.org/class/yago/WikicatHighKingsOfIreland', 'http://dbpedia.org/class/yago/Wikicat5th-centuryIrishPeople', 'http://dbpedia.org/class/yago/WikicatIrishSoldiers', 'http://dbpedia.org/class/yago/Wikicat5th-centuryIrishMonarchs', 'http://dbpedia.org/class/yago/WikicatKingsOfConnacht', 'http://dbpedia.org/class/yago/Wikicat4th-centuryIrishPeople', 'http://dbpedia.org/class/yago/WikicatFast-foodChainsOfTheUnitedStates', 'http://dbpedia.org/class/yago/Wikicat4th-centuryIrishMonarchs', 'http://dbpedia.org/class/yago/WikicatMedievalIrishPeople', 'http://dbpedia.org/class/yago/WikicatPsychologicalTheories', 'http://dbpedia.org/class/yago/WikicatMind–bodyInterventions', 'http://dbpedia.org/class/yago/Billionaire110529684', 'http://dbpedia.org/class/yago/RichPerson110529231', 'http://dbpedia.org/class/yago/WikicatAmericanBillionaires', 'http://dbpedia.org/class/yago/Restaurateur110524869', 'http://dbpedia.org/class/yago/Employee110053808', 'http://dbpedia.org/class/yago/WikicatAmericanRestaurateurs', 'http://dbpedia.org/class/yago/WikicatAmericanVideoGameDesigners', 'http://dbpedia.org/class/yago/WikicatAmericanInvestors', 'http://dbpedia.org/class/yago/WikicatAmericanRadioProducers', 'http://dbpedia.org/class/yago/Explanation105793000', 'http://dbpedia.org/class/yago/Theory105989479', 'http://dbpedia.org/class/yago/WikicatAmericanGameShowHosts', 'http://dbpedia.org/class/yago/WikicatAmericanBusinessWriters', 'http://dbpedia.org/class/yago/Merchant110309896', 'http://dbpedia.org/class/yago/WikicatCelticChristianBishops', 'http://dbpedia.org/class/yago/WikicatBritishSlaves', 'http://dbpedia.org/class/yago/WikicatNorthernBrythonicSaints', 'http://dbpedia.org/class/yago/WikicatChristianMissionaries', 'http://dbpedia.org/class/yago/WikicatMedievalIrishWriters', 'http://dbpedia.org/class/yago/WikicatIrishBishops', 'http://dbpedia.org/class/yago/WikicatArchbishopsOfArmagh', 'http://dbpedia.org/class/yago/Wikicat5th-centuryChristianSaints', 'http://dbpedia.org/class/yago/WikicatIrishRomanCatholicSaints', 'http://dbpedia.org/class/yago/Wikicat5th-centuryWriters', 'http://dbpedia.org/class/yago/WikicatChurchFathers', 'http://dbpedia.org/class/yago/Wikicat5th-centuryPeople', 'http://dbpedia.org/class/yago/Wikicat5th-centuryBishops', 'http://dbpedia.org/class/yago/WikicatChristianMissionariesInIreland', 'http://dbpedia.org/class/yago/Father110080869', 'http://dbpedia.org/class/yago/WikicatRomano-BritishSaints', 'http://dbpedia.org/class/yago/WikicatWritersOfCaptivityNarratives', 'http://dbpedia.org/class/yago/Archbishop109805151', 'http://dbpedia.org/class/yago/WikicatIrishSaints', 'http://dbpedia.org/class/yago/WikicatBritishBishops', 'http://dbpedia.org/class/yago/WikicatPre-diocesanBishopsInIreland', 'http://dbpedia.org/class/yago/WikicatMedievalIrishSaints', 'http://dbpedia.org/class/yago/WikicatSlaves', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionProducers', 'http://dbpedia.org/class/yago/Owner110388924', 'http://dbpedia.org/class/yago/Businessman109882007', 'http://dbpedia.org/class/yago/WikicatConspiracyTheorists', 'http://dbpedia.org/class/yago/WikicatAmericanStockTraders', 'http://dbpedia.org/class/yago/WikicatAmericanFinanciers', 'http://dbpedia.org/class/yago/Trader110720453', 'http://dbpedia.org/class/yago/StockTrader110657835', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionDirectors', 'http://dbpedia.org/class/yago/Businessperson109882716', 'http://dbpedia.org/class/yago/Chain108057816', 'http://dbpedia.org/class/yago/RestaurantChain108061801', 'http://dbpedia.org/class/yago/WikicatCompaniesEstablishedIn1971', 'http://dbpedia.org/class/yago/WikicatCompaniesBasedInSeattle,Washington', 'http://dbpedia.org/class/yago/WikicatRetailCompaniesEstablishedIn1971', 'http://dbpedia.org/class/yago/WikicatCoffeeCompanies', 'http://dbpedia.org/class/yago/WikicatWritersFromFlorida', 'http://dbpedia.org/class/yago/WikicatUnitedStatesFootballLeagueExecutives', 'http://dbpedia.org/class/yago/WikicatTelevisionProducersFromNewYork', 'http://dbpedia.org/class/yago/WikicatNewYorkMilitaryAcademyAlumni', 'http://dbpedia.org/class/yago/WikicatChiefExecutives', 'http://dbpedia.org/class/yago/WikicatBusinessEducators', 'http://dbpedia.org/class/yago/WikicatBoardGameDesigners', 'http://dbpedia.org/class/yago/WikicatAmericanPoliticalFundraisers', 'http://dbpedia.org/class/yago/WikicatAmericanFinancialLiteracyActivists', 'http://dbpedia.org/class/yago/WikicatAmericanBeautyPageantOwners', 'http://dbpedia.org/class/yago/WikicatAmericanAirlineChiefExecutives', 'http://dbpedia.org/class/yago/Solicitor110623354', 'http://dbpedia.org/class/yago/Petitioner110420031', 'http://dbpedia.org/class/yago/InvestmentAdviser110215815', 'http://dbpedia.org/class/yago/Fundraiser110116478', 'http://dbpedia.org/class/yago/Applicant109607280', 'http://dbpedia.org/class/yago/WikicatAmericanFinancialCommentators', 'http://dbpedia.org/class/yago/WikicatFordhamUniversityAlumni', 'http://dbpedia.org/class/yago/WikicatAmericanRealityTelevisionProducers', 'http://dbpedia.org/class/yago/WikicatAmericanInvestmentAdvisors', 'http://dbpedia.org/class/yago/WikicatTheTrumpOrganizationEmployees', 'http://dbpedia.org/class/yago/WikicatAmericanChiefExecutives', 'http://dbpedia.org/class/yago/WikicatIrishKings', 'http://dbpedia.org/class/yago/King110231515', 'http://dbpedia.org/class/yago/Socialite110619409', 'http://dbpedia.org/class/yago/Thinking105770926', 'http://dbpedia.org/class/yago/HigherCognitiveProcess105770664')
                                      GROUP BY t.id
                                    ) SEPARATOR '---' ) AS types
                        FROM chat_tweets t
                        WHERE contabilizar = 1
                        AND drunk = 'S'
                  UNION
                SELECT GROUP_CONCAT(
                                    (
                                      SELECT GROUP_CONCAT(DISTINCT(tn.palavra) SEPARATOR '---')
                                      FROM chat_tweets_nlp tn
                                      WHERE tn.idTweet = t.id
                                      AND palavra IN ('mention', 'Hashtag', 'url', '/religion and spirituality/hinduism', '/religion and spirituality/buddhism', 'Download  Pilot', 'highest score', 'Miley Cyrus', 'giveaway', 'Billy Ray Cyrus', '/technology and computing/mp3 and midi', '/art and entertainment/movies and tv/children\\'s', '/technology and computing/software', '/food and drink', 'media', '/religion and spirituality/christianity', '/technology and computing/internet technology/web search', '/health and fitness/addiction/alcoholism', '/food and drink/beverages/alcoholic beverages/cocktails and beer', '/sports/bowling', '/food and drink/beverages', '/sports/cricket', '/food and drink/beverages/alcoholic beverages', '/food and drink/beverages/alcoholic beverages/wine', 'Saint Patrick\\'s Day', '/food and drink/beverages/non alcoholic beverages/soft drinks', '/society/dating', 'Quantity', 'Saint Patrick', '/business and industrial/business operations/business plans', '/society/unrest and war', '#media', '/food and drink/beverages/non alcoholic beverages/bottled water', 'bottle', '/health and fitness/drugs', '/family and parenting/children', 'mention Thanks', '/technology and computing/internet technology/email', '/sports/table tennis and ping-pong', 'drugs', '/health and fitness/addiction', '/health and fitness/addiction/smoking addiction', '/shopping/retail/outlet stores', 'Shamrock', '/religion and spirituality/islam', 'Irish folklore', 'https', '/society/social institution/divorce', '/business and industrial/advertising and marketing/advertising', 'store', '/automotive and vehicles/minivan', '/automotive and vehicles/boats and watercraft', '/art and entertainment/movies and tv/movies/reviews', 'gt', 'last night', '/art and entertainment/books and literature', 'Person', 'shots', '/food and drink/food', '/technology and computing/programming languages/javascript', 'Drug', 'wine', '#mention #media', 'Starbucks', '/law, govt and politics/politics/elections/presidential elections', '/law, govt and politics', 'text', 'Alcoholic beverage', 'St. Patrick\\'s Day')
                                      GROUP BY tn.idTweet
                                    ) SEPARATOR '---') AS entidades,
                        GROUP_CONCAT(
                                    (
                                      SELECT GROUP_CONCAT(DISTINCT(REPLACE(ty.type, 'http://dbpedia.org/class/', '')) SEPARATOR '---')
                                      FROM chat_tweets_nlp tn
                                      JOIN chat_tweets_conceito c ON c.palavra = tn.palavra
                                      JOIN resource_type ty ON ty.resource = c.resource
                                      WHERE tn.idTweet = t.id
                                      AND ty.type IN ('http://dbpedia.org/class/yago/WikicatVirtualCommunities', 'http://dbpedia.org/class/yago/Gathering107975026', 'http://dbpedia.org/class/yago/Community108223802', 'http://dbpedia.org/ontology/RecordLabel', 'http://dbpedia.org/class/yago/SocialGroup107950920', 'http://dbpedia.org/class/yago/Group100031264', 'http://dbpedia.org/class/yago/Abstraction100002137', 'http://dbpedia.org/class/yago/WikicatOccupationsInAviation', 'http://dbpedia.org/class/yago/WikicatMilitaryAviationOccupations', 'http://dbpedia.org/class/yago/WikicatPeopleFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatWaltDisneyRecordsArtists', 'http://dbpedia.org/class/yago/WikicatHollywoodRecordsArtists', 'http://dbpedia.org/class/yago/WikicatFascinationRecordsArtists', 'http://dbpedia.org/class/yago/WikicatMusiciansFromTennessee', 'http://dbpedia.org/class/yago/WikicatChildActors', 'http://dbpedia.org/class/yago/WikicatPeopleFromTennessee', 'http://dbpedia.org/class/yago/WikicatActorsFromTennessee', 'http://dbpedia.org/class/yago/WikicatActressesFromTennessee', 'http://dbpedia.org/class/yago/WikicatAmericanChildActresses', 'http://dbpedia.org/class/yago/WikicatAmericanChildActors', 'http://dbpedia.org/class/yago/WikicatAmericanFemaleDancers', 'http://dbpedia.org/class/yago/WikicatMusiciansFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatActressesFromNashville,Tennessee', 'http://dbpedia.org/class/yago/WikicatRCARecordsArtists', 'http://dbpedia.org/class/yago/WikicatChildPopMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanFemalePopSingers', 'http://dbpedia.org/class/yago/Dancer109989502', 'http://dbpedia.org/class/yago/WikicatAmericanGuitarists', 'http://dbpedia.org/class/yago/WikicatLGBTRightsActivistsFromTheUnitedStates', 'http://dbpedia.org/class/yago/WikicatAmericanVoiceActresses', 'http://dbpedia.org/class/yago/WikicatAmericanChildSingers', 'http://dbpedia.org/class/yago/Pianist110430665', 'http://dbpedia.org/class/yago/WikicatAmericanPianists', 'http://dbpedia.org/class/yago/WikicatAmericanVoiceActors', 'http://dbpedia.org/class/yago/WikicatAmericanDanceMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanActresses', 'http://dbpedia.org/class/yago/Guitarist110151760', 'http://dbpedia.org/class/yago/WikicatPopSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryActresses', 'http://dbpedia.org/class/yago/WikicatAmericanFemaleSingers', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionActresses', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionActors', 'http://dbpedia.org/class/yago/WikicatAmericanHipHopSingers', 'http://dbpedia.org/class/yago/Occupation100582388', 'http://dbpedia.org/class/yago/WikicatAmericanFilmActresses', 'http://dbpedia.org/class/yago/WikicatAmericanSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryAmericanActresses', 'http://dbpedia.org/class/yago/WikicatAmericanPopSingers', 'http://dbpedia.org/class/yago/WikicatEnglish-languageSingers', 'http://dbpedia.org/class/yago/Wikicat21st-centuryActors', 'http://dbpedia.org/class/yago/Wikicat21st-centuryAmericanSingers', 'http://dbpedia.org/class/yago/Actress109767700', 'http://dbpedia.org/class/yago/WikicatActors', 'http://dbpedia.org/class/yago/WikicatAmericanMusicians', 'http://dbpedia.org/class/yago/WikicatAmericanActors', 'http://dbpedia.org/class/yago/WikicatWomen', 'http://dbpedia.org/class/yago/Militant110315837', 'http://umbel.org/umbel/rc/MusicalPerformer', 'http://dbpedia.org/class/yago/Female109619168', 'http://dbpedia.org/class/yago/Woman110787470', 'http://dbpedia.org/class/yago/Disputant109615465', 'http://dbpedia.org/class/yago/Reformer110515194', 'http://dbpedia.org/class/yago/Actor109765278', 'http://dbpedia.org/class/yago/Singer110599806', 'http://dbpedia.org/ontology/MusicalArtist', 'http://dbpedia.org/class/yago/WikicatAmericanPeople', 'http://www.w3.org/2002/07/owl#Thing', 'http://dbpedia.org/class/yago/Musician110340312', 'http://dbpedia.org/class/yago/Musician110339966', 'http://dbpedia.org/class/yago/Artist109812338', 'http://dbpedia.org/class/yago/Performer110415638', 'http://dbpedia.org/class/yago/Entertainer109616922', 'http://dbpedia.org/class/yago/Adult109605289', 'http://dbpedia.org/class/yago/Activity100407535', 'http://dbpedia.org/class/yago/Creator109614315', 'http://dbpedia.org/class/yago/CausalAgent100007347', 'http://dbpedia.org/class/yago/Organism100004475', 'http://dbpedia.org/class/yago/LivingThing100004258', 'http://dbpedia.org/class/yago/Person100007846', 'http://dbpedia.org/ontology/Building', 'http://dbpedia.org/class/yago/Act100030358', 'http://dbpedia.org/class/yago/Event100029378', 'http://dbpedia.org/ontology/Person', 'http://dbpedia.org/class/yago/WikicatLivingPeople', 'http://www.ontologydesignpatterns.org/ont/dul/DUL.owl#NaturalPerson', 'http://schema.org/Person', 'http://www.wikidata.org/entity/Q5', 'http://www.wikidata.org/entity/Q215627', 'http://xmlns.com/foaf/0.1/Person', 'http://dbpedia.org/class/yago/PsychologicalFeature100023100', 'http://dbpedia.org/class/yago/Maker110284064', 'http://dbpedia.org/class/yago/Manufacturer110292316', 'http://dbpedia.org/class/yago/YagoLegalActor', 'http://dbpedia.org/class/yago/WikicatHighKingsOfIreland', 'http://dbpedia.org/class/yago/Wikicat5th-centuryIrishPeople', 'http://dbpedia.org/class/yago/WikicatIrishSoldiers', 'http://dbpedia.org/class/yago/Wikicat5th-centuryIrishMonarchs', 'http://dbpedia.org/class/yago/WikicatKingsOfConnacht', 'http://dbpedia.org/class/yago/Wikicat4th-centuryIrishPeople', 'http://dbpedia.org/class/yago/WikicatFast-foodChainsOfTheUnitedStates', 'http://dbpedia.org/class/yago/Wikicat4th-centuryIrishMonarchs', 'http://dbpedia.org/class/yago/WikicatMedievalIrishPeople', 'http://dbpedia.org/class/yago/WikicatPsychologicalTheories', 'http://dbpedia.org/class/yago/WikicatMind–bodyInterventions', 'http://dbpedia.org/class/yago/Billionaire110529684', 'http://dbpedia.org/class/yago/RichPerson110529231', 'http://dbpedia.org/class/yago/WikicatAmericanBillionaires', 'http://dbpedia.org/class/yago/Restaurateur110524869', 'http://dbpedia.org/class/yago/Employee110053808', 'http://dbpedia.org/class/yago/WikicatAmericanRestaurateurs', 'http://dbpedia.org/class/yago/WikicatAmericanVideoGameDesigners', 'http://dbpedia.org/class/yago/WikicatAmericanInvestors', 'http://dbpedia.org/class/yago/WikicatAmericanRadioProducers', 'http://dbpedia.org/class/yago/Explanation105793000', 'http://dbpedia.org/class/yago/Theory105989479', 'http://dbpedia.org/class/yago/WikicatAmericanGameShowHosts', 'http://dbpedia.org/class/yago/WikicatAmericanBusinessWriters', 'http://dbpedia.org/class/yago/Merchant110309896', 'http://dbpedia.org/class/yago/WikicatCelticChristianBishops', 'http://dbpedia.org/class/yago/WikicatBritishSlaves', 'http://dbpedia.org/class/yago/WikicatNorthernBrythonicSaints', 'http://dbpedia.org/class/yago/WikicatChristianMissionaries', 'http://dbpedia.org/class/yago/WikicatMedievalIrishWriters', 'http://dbpedia.org/class/yago/WikicatIrishBishops', 'http://dbpedia.org/class/yago/WikicatArchbishopsOfArmagh', 'http://dbpedia.org/class/yago/Wikicat5th-centuryChristianSaints', 'http://dbpedia.org/class/yago/WikicatIrishRomanCatholicSaints', 'http://dbpedia.org/class/yago/Wikicat5th-centuryWriters', 'http://dbpedia.org/class/yago/WikicatChurchFathers', 'http://dbpedia.org/class/yago/Wikicat5th-centuryPeople', 'http://dbpedia.org/class/yago/Wikicat5th-centuryBishops', 'http://dbpedia.org/class/yago/WikicatChristianMissionariesInIreland', 'http://dbpedia.org/class/yago/Father110080869', 'http://dbpedia.org/class/yago/WikicatRomano-BritishSaints', 'http://dbpedia.org/class/yago/WikicatWritersOfCaptivityNarratives', 'http://dbpedia.org/class/yago/Archbishop109805151', 'http://dbpedia.org/class/yago/WikicatIrishSaints', 'http://dbpedia.org/class/yago/WikicatBritishBishops', 'http://dbpedia.org/class/yago/WikicatPre-diocesanBishopsInIreland', 'http://dbpedia.org/class/yago/WikicatMedievalIrishSaints', 'http://dbpedia.org/class/yago/WikicatSlaves', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionProducers', 'http://dbpedia.org/class/yago/Owner110388924', 'http://dbpedia.org/class/yago/Businessman109882007', 'http://dbpedia.org/class/yago/WikicatConspiracyTheorists', 'http://dbpedia.org/class/yago/WikicatAmericanStockTraders', 'http://dbpedia.org/class/yago/WikicatAmericanFinanciers', 'http://dbpedia.org/class/yago/Trader110720453', 'http://dbpedia.org/class/yago/StockTrader110657835', 'http://dbpedia.org/class/yago/WikicatAmericanTelevisionDirectors', 'http://dbpedia.org/class/yago/Businessperson109882716', 'http://dbpedia.org/class/yago/Chain108057816', 'http://dbpedia.org/class/yago/RestaurantChain108061801', 'http://dbpedia.org/class/yago/WikicatCompaniesEstablishedIn1971', 'http://dbpedia.org/class/yago/WikicatCompaniesBasedInSeattle,Washington', 'http://dbpedia.org/class/yago/WikicatRetailCompaniesEstablishedIn1971', 'http://dbpedia.org/class/yago/WikicatCoffeeCompanies', 'http://dbpedia.org/class/yago/WikicatWritersFromFlorida', 'http://dbpedia.org/class/yago/WikicatUnitedStatesFootballLeagueExecutives', 'http://dbpedia.org/class/yago/WikicatTelevisionProducersFromNewYork', 'http://dbpedia.org/class/yago/WikicatNewYorkMilitaryAcademyAlumni', 'http://dbpedia.org/class/yago/WikicatChiefExecutives', 'http://dbpedia.org/class/yago/WikicatBusinessEducators', 'http://dbpedia.org/class/yago/WikicatBoardGameDesigners', 'http://dbpedia.org/class/yago/WikicatAmericanPoliticalFundraisers', 'http://dbpedia.org/class/yago/WikicatAmericanFinancialLiteracyActivists', 'http://dbpedia.org/class/yago/WikicatAmericanBeautyPageantOwners', 'http://dbpedia.org/class/yago/WikicatAmericanAirlineChiefExecutives', 'http://dbpedia.org/class/yago/Solicitor110623354', 'http://dbpedia.org/class/yago/Petitioner110420031', 'http://dbpedia.org/class/yago/InvestmentAdviser110215815', 'http://dbpedia.org/class/yago/Fundraiser110116478', 'http://dbpedia.org/class/yago/Applicant109607280', 'http://dbpedia.org/class/yago/WikicatAmericanFinancialCommentators', 'http://dbpedia.org/class/yago/WikicatFordhamUniversityAlumni', 'http://dbpedia.org/class/yago/WikicatAmericanRealityTelevisionProducers', 'http://dbpedia.org/class/yago/WikicatAmericanInvestmentAdvisors', 'http://dbpedia.org/class/yago/WikicatTheTrumpOrganizationEmployees', 'http://dbpedia.org/class/yago/WikicatAmericanChiefExecutives', 'http://dbpedia.org/class/yago/WikicatIrishKings', 'http://dbpedia.org/class/yago/King110231515', 'http://dbpedia.org/class/yago/Socialite110619409', 'http://dbpedia.org/class/yago/Thinking105770926', 'http://dbpedia.org/class/yago/HigherCognitiveProcess105770664')
                                      GROUP BY t.id
                                    ) SEPARATOR '---' ) AS types
                        FROM chat_tweets t
                        WHERE contabilizar = 1
                        AND drunk = 'N'
                  ")

# dados <- query("SELECT GROUP_CONCAT(tn.palavra SEPARATOR '---') as entidades
#                FROM tweets_nlp tn
#                JOIN tweets t ON tn.idTweetInterno = t.idInterno
#                WHERE q2 = 1
#                UNION
#                SELECT GROUP_CONCAT(tn.palavra SEPARATOR '---') as entidades
#                FROM tweets_nlp tn
#                JOIN tweets t ON tn.idTweetInterno = t.idInterno
#                WHERE q1 = 0")


dados$entidades <- enc2utf8(dados$entidades)
dados$entidades <- iconv(dados$entidades, to='ASCII//TRANSLIT')
dados$entidades = gsub(" ", "_", dados$entidades)
dados$entidades = gsub("---", " ", dados$entidades)
dados$entidades = gsub("/", " ", dados$entidades)

dados$types <- enc2utf8(dados$types)
dados$types <- iconv(dados$types, to='ASCII//TRANSLIT')
dados$types = gsub(" ", "_", dados$types)
dados$types = gsub("---", " ", dados$types)
dados$types = gsub("/", " ", dados$types)

stop_words = tm::stopwords("en")

library(tm)
library(dplyr)
library(xtable)

docs <- Corpus(VectorSource(dados$entidades)) %>%
  tm_map(removePunctuation) %>%
  # tm_map(removeNumbers) %>%
  tm_map(tolower)  %>%
  tm_map(removeWords, stopwords("english")) %>%
  tm_map(stripWhitespace) %>%
  tm_map(PlainTextDocument)

tdm <- TermDocumentMatrix(docs) %>%
  as.matrix()
colnames(tdm) <- c("Drunk","Sober")

par(mfrow=c(1,1))
comparison.cloud(tdm, random.order=FALSE, colors = c("indianred3","blue3"),
                 title.size=2, max.words=200)

warnings()
#tdmMatrix <- as.matrix(tfNeg)
#dados$entidades
#paste(unlist(dados$entidades), collapse =". ")